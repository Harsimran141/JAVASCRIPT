<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body>
    <div class="max-w-md bg-blue-500 mx-auto h-[400px]">
        <h1 class="text-center text-white text-2xl">Online-User</h1>
        <p id="display"></p>
    </div>

    <script>
        const display = document.getElementById("display");
        console.log(display);

        async function online() {
            try {
                let storagedata = (localStorage.getItem('record'))
                let objdata = JSON.parse(storagedata)

                let accessToken = objdata.data.accessToken;

                let option = {
                    method: "GET",
                    headers: {
                        accept: 'application/json',
                        'content-type': 'application/json',
                        Authorization: `Bearer ${accessToken}`,
                    },
                }
                let response = await fetch("https://api.freeapi.app/api/v1/chat-app/chats/users", option)
                let reciveddata = await response.json();
                let show = ""
                reciveddata.data.forEach(element => {
                    console.log("username", element);
                    show +=
                        `<h1 class="p-2 text-xl text-700 hover:bg-white mt-1 rounded-md listitem" id="${element._id}">${element.username}</h1>`
                });
                display.innerHTML = show
                let list = document.querySelectorAll(".listitem");
                list.forEach(newlist => {
                    newlist.addEventListener('click', function () {
                        let ulist = newlist.getAttribute("id")
                        localStorage.setItem("reciverid", ulist)
                        window.location = "Uchat.html"
                    })
                })
            } catch (e) {
                console.log(e);
            }
        }
        online()
        console.log("hello");
    </script>
</body>

</html>